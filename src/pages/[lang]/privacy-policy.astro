---
import Layout from "Layout.astro";
import defaultTemplateConfig from "utils/config";
import { getTranslations, getSupportedLanguages } from "utils/serverI18n";
import InitScripts from "../../components/initScripts";
import Navbar from "../../components/navbar";
import AppBanner from "../../components/appBanner";
import Footer from "../../components/footer";
import PrivacyPolicyContent from "@modules/privacyPolicy";

export function getStaticPaths() {
  const languages = getSupportedLanguages();

  // Exclude 'en' since English is at root level (/)
  return languages
    .filter(lang => lang !== 'en')
    .map(lang => ({
      params: { lang },
      props: {
        lang,
        translations: getTranslations(lang),
      }
    }));
}

const { lang } = Astro.params;
const { translations } = Astro.props;

// Get language-specific SEO from config
const seo = defaultTemplateConfig.privacyPolicy?.[lang]?.seo || defaultTemplateConfig.privacyPolicy?.en?.seo;
---

<Layout
  {...defaultTemplateConfig}
  seo={seo}
  currentLang={lang}
  translations={translations}
>
  <InitScripts client:load />
  <main>
    <Navbar client:load config={defaultTemplateConfig} lang={lang} />
    <PrivacyPolicyContent client:only="react" config={defaultTemplateConfig} />
    <AppBanner client:visible config={defaultTemplateConfig} />
    <Footer client:idle config={defaultTemplateConfig} lang={lang} />
  </main>
</Layout>
