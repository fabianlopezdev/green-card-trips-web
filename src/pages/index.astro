---
import Layout from "@layouts/Layout.astro"
import defaultTemplateConfig from "@utils/config"
import { generateFAQPageSchema, generateReviewSchema, generateProductSchema } from "@utils/structuredData"
import Navbar from "@components/navbar/index.astro"
import Header from "@modules/home/_components/header/index.astro"
import Partners from "@modules/home/_components/partners/partners.astro"
import Features from "@modules/home/_components/features/features.astro"
import HowItWorks from "@modules/home/_components/howItWorks/howItWorks.astro"
import Pricing from "@modules/home/_components/pricing/pricing.astro"
import Testimonials from "@modules/home/_components/testimonials/index.astro"
import Faq from "@modules/home/_components/faq/faq.astro"
import AppBanner from "@components/appBanner/index.astro"
import Footer from "@components/footer/index.astro"
import enTranslations from "@i18n/locales/en.json"

// English legal page URLs (at root level)
const legalUrls = {
  termsAndConditions: '/terms-and-conditions',
  privacyPolicy: '/privacy-policy',
  cookiesPolicy: '/cookies-policy',
};

// Generate FAQPage schema with actual FAQ content from translations
const faqs = [
  { question: enTranslations.faq.q1.question, answer: enTranslations.faq.q1.answer },
  { question: enTranslations.faq.q2.question, answer: enTranslations.faq.q2.answer },
  { question: enTranslations.faq.q3.question, answer: enTranslations.faq.q3.answer },
  { question: enTranslations.faq.q4.question, answer: enTranslations.faq.q4.answer },
  { question: enTranslations.faq.q5.question, answer: enTranslations.faq.q5.answer },
];
const faqSchema = generateFAQPageSchema(faqs);

// Generate Review schemas for testimonials
const reviewSchemas = generateReviewSchema(defaultTemplateConfig);

// Generate Product schema for pricing with production URL
const siteUrl = Astro.site || new URL(Astro.url.origin);
const currentPageUrl = new URL(Astro.url.pathname, siteUrl).href;
const productSchema = generateProductSchema(defaultTemplateConfig, currentPageUrl);
---

<Layout {...defaultTemplateConfig}>
  <!-- FAQPage Structured Data -->
  <script is:inline type="application/ld+json" set:html={JSON.stringify(faqSchema)} slot="head" />

  <!-- Review Structured Data for Testimonials -->
  {reviewSchemas.map((review) => (
    <script is:inline type="application/ld+json" set:html={JSON.stringify(review)} slot="head" />
  ))}

  <!-- Product Structured Data -->
  <script is:inline type="application/ld+json" set:html={JSON.stringify(productSchema)} slot="head" />

  
  <header>
    <Navbar config={defaultTemplateConfig} translations={enTranslations} currentLang="en" />
  </header>
  <main id="main">
    <Header config={defaultTemplateConfig} translations={enTranslations} currentLang="en" />
    <Partners config={defaultTemplateConfig} translations={enTranslations} currentLang="en" />
    <Features config={defaultTemplateConfig} translations={enTranslations} currentLang="en" />
    <HowItWorks config={defaultTemplateConfig} translations={enTranslations} currentLang="en" />
    <Pricing config={defaultTemplateConfig} translations={enTranslations} currentLang="en" />
    <Testimonials config={defaultTemplateConfig} />
    <Faq config={defaultTemplateConfig} translations={enTranslations} currentLang="en" />
    <AppBanner config={defaultTemplateConfig} translations={enTranslations} currentLang="en" />
    <Footer config={defaultTemplateConfig} translations={enTranslations} currentLang="en" legalUrls={legalUrls} />
  </main>
</Layout>
