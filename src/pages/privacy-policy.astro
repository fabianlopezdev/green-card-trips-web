---
import BaseLayout from "@layouts/BaseLayout.astro";
import defaultTemplateConfig from "@utils/config";
import { generateBreadcrumbSchema } from "@utils/structuredData";
import PrivacyPolicyContent from "@components/legal/PrivacyPolicy.astro";
import { getLegalEntry } from "@utils/getLegalEntry";
import enTranslations from "@i18n/locales/en.json";

// Generate site URL for breadcrumbs
const siteUrl = Astro.site || new URL(Astro.url.origin);

const privacyEntry = await getLegalEntry("privacy-policy", "en");

// Generate breadcrumb schema
const breadcrumbs = [
  { name: "Home", url: new URL('/', siteUrl).href },
  { name: privacyEntry.data.title, url: new URL('/privacy-policy', siteUrl).href }
];
const breadcrumbSchema = generateBreadcrumbSchema(breadcrumbs);
---

<BaseLayout
  {...defaultTemplateConfig}
  seo={privacyEntry.data.seo}
  currentLang="en"
  translations={enTranslations}
>
  <!-- BreadcrumbList Structured Data -->
  <script is:inline type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} slot="head" />

  <PrivacyPolicyContent currentLang="en" />
</BaseLayout>
